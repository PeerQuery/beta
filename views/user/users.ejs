
<!DOCTYPE html>
<html>
<head>
  <!-- Standard Meta -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <!-- Site Properties -->
	<meta name="description" content="">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="Peer Query">
	<meta property="og:title" content="Peer Query">
	<meta property="og:description" content="">
	<meta property="og:image" content="https://www.peerquery.com/assets/images/peerquery.png">
	<meta property="fb:app_id" content="384491628645652">
	<link rel="icon" type="image/x-icon" href="/assets/img/favicon.ico">
	<meta name="application-name" content="Peer Query">
	<title>Users - Peer Query</title>

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.css" />
  <link rel="stylesheet" href="/assets/css/custom.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.js"></script>
  <script src="/assets/scripts/timeago.js"></script>
  <script src="https://cdn.steemjs.com/lib/latest/steem.min.js"></script>
	<script src="/assets/scripts/sc2.min.js"></script>

</head>
<body>



<section class="navbarSection">
	<% include ../partials/navbar.ejs %>
</section>



	
  <div class="ui container">
	
<div class="two column stackable ui grid">
	
	<section name="main content" class="eleven wide column">
	
	
	
	
	<!-- query type menu -->
		<div class="ui four item menu">
			<a class="item active" id="trending" onClick="fetch_tags('/api/hot_tags/0')">
				<i class="dollar icon"></i>
				<span class="desktop-only">Hot</span>
			</a>
			<a class="item" id="new" onClick="fetch_tags('/api/new_tags/0')">
				<i class="wait icon"></i>
				<span class="desktop-only">New</span>
			</a>
			<a class="item" id="hot" onClick="fetch_tags('/api/top_tags/0')">
				<i class="line chart icon"></i>
				<span class="desktop-only">Top</span>
			</a>
			<a class="item" id="by-votes" onClick="fetch_tags('/api/old_tags/0')">
				<i class="star icon"></i>
				<span class="desktop-only">Old</span>
			</a>
		</div>
	<!-- end of query type menu -->
	
	
	
	  
<div id="main-content" style="">
	
	
	
	
	
	<br/>
	<br/>
	
	
    <div class="ui large active centered inline loader" id="loader"></div>
	
	
	
	
	
	
	<div class="ui three stackable link cards" id="user_list">
	
  
	</div>
	
	
	
	
	
	<br/>
	
	
  
  
  </div>

	
	</section>
	
	
	
	
	<section name="sidebar" class="five wide column">
	
	
	

	<div class="ui teal segment">
		
		<div class="ui list">
		
		<a class="item" title="Current SQP price quote">
			<div class="header right floated" id="sdb-quote">--</div>
			<div class="content">
			<div class="description">
				<i class="chart line icon"></i>
				SDB to STEEM quote
			</div>
			</div>
		</a>
  
		</div>
		
	</div>
	
	
	
	
	
	<br/>
	
	
	
	
	
	
	
	<div class="ui segment" id="featured-queries-section" style="display:none">
	
    <a class="ui red ribbon label" href="/queries">Featured</a>
	
	<div class="ui feed" id="featured_queries">
	
	</div>
	
	
	</div>
	
	
	
	
	
	
	
	<div class="ui purple segment" id="from-blog" style="display:none">
	
      <a class="ui red ribbon label" href="http://steemit.com/@peerquery" target="_blank">From our blog</a>
		
		<br/><br/>
		
		<div id="last-blog-post">		</div>
		
	</div>
	
	
	
	
	
	
	
	
	
	
	</section>
	
	
</div>
	  
	</div>
	
	
	
	
	<section class="footerSection">
		<% include ../partials/footer.ejs %>
	</section>

	
	
	
	
  <script>
	//
	
	steem.api.getDiscussionsByBlog({"tag": "peerquery", "limit": 1}, function(err, blog_result) {
	
		//console.log(err, result);
	
		document.getElementById("last-blog-post").innerHTML = "<a href='/" + blog_result[0].parent_permlink + "/@" + blog_result[0].author + "/" + blog_result[0].permlink + "'>" + blog_result[0].title + "</a>";
	
		document.getElementById("from-blog").style.display = "block";
	
	});
	
	
	steem.api.getCurrentMedianHistoryPrice(function(err, result) {
		//console.log(err, result);
		//console.log(result.base);
		document.getElementById("sdb-quote").innerText = result.base;
	});
	


	
	
	$.get("/api/featured_queries", function(data, status){
		console.log(data);
		
		for (x in data[0]) {
			list_featured_queries(data[0][x]);
		}
		
		document.getElementById("featured-queries-section").style.display = "block";
		
		timeAgo();
		
	});
	
	
	
	function list_featured_queries(query) {
		
		var divMain = document.createElement("div");
		divMain.className = "event";
		
		var divLabel = document.createElement("div");
		divLabel.className = "label";
		
		var user_img = document.createElement("img");
		user_img.src = "https://img.busy.org/@" + query.account;
		user_img.onerror = function() {this.src='/assets/img/avatar.png'; this.onerror='';};
		divLabel.appendChild(user_img);
		
		
		var divContent = document.createElement("div");
		divContent.className = "content";
		
		
		var divMeta = document.createElement("div");
		divMeta.className = "date";
		divMeta.innerHTML = "<span class = 'timeago' title = '" + query.created + "'></span> by <a href='/@" + query.account + "'>" + query.account + "</a> in " + "<a href='/tags/" + query.type + "'>" + query.type + "</a>";
		divContent.appendChild(divMeta);
		
		
		
		var divSummary = document.createElement("div");
		divSummary.className = "summary";
		
		var query_title = document.createElement("a");
		query_title.innerText = query.title.substring(0, 65) + " ...";
		query_title.href = "/@" + query.account + "/" + query.permlink;
		divSummary.appendChild(query_title);
		
		
		divContent.appendChild(divMeta);
		divContent.appendChild(divSummary);
		
		
		divMain.appendChild(divLabel);
		divMain.appendChild(divContent);
		
		
		document.getElementById("featured_queries").appendChild(divMain);
			
	}
	
	
		
	function list_featured_users(user) {
		
		
		var divItem = document.createElement("div");
		divItem.className = "item";
		
		var user_img = document.createElement("img");
		user_img.className = "ui avatar image";
		user_img.src = "https://img.busy.org/@" + user.account;
		user_img.onerror = function() {this.src='/assets/img/avatar.png'; this.onerror='';};
		divItem.appendChild(user_img);
		
		var divContent = document.createElement("div");
		divContent.className = "content";
		
		var aHeader = document.createElement("a");
		aHeader.className = "header";
		aHeader.href = "/@" + user.account;
		aHeader.innerText = user.account;
		divContent.appendChild(aHeader);
		
		var divDescription = document.createElement("div");
		divDescription.className = "description timeago";
		divDescription.title = user.created;
		divContent.appendChild(divDescription);
		
		
		divItem.appendChild(user_img);
		divItem.appendChild(divContent);
		
		document.getElementById("featured_users").appendChild(divItem);

	}
	
  

  
  
	
		
	function list_users(user) {
		
		
		var divCard = document.createElement("div");
		divCard.className = "ui card";
		
		var divHeadContent = document.createElement("div");
		divHeadContent.className = "content";
		
		var divDetail = document.createElement("div");
		divDetail.className = "right floated meta";
		divDetail.innerText = "#" + user.user_number
		
		var user_img = document.createElement("img");
		user_img.className = "ui avatar image";
		user_img.src = "https://img.busy.org/@" + user.account;
		user_img.width = "300";
		user_img.height = "300";
		user_img.onerror = function() {this.src='/assets/img/avatar.png'; this.onerror='';};
		
		divHeadContent.appendChild(divDetail);
		divHeadContent.appendChild(user_img);
		
		
		
		divCard.appendChild(divHeadContent);
		
		
		var divContent = document.createElement("div");
		divContent.className = "content";
		
		var divHeader = document.createElement("div");
		divHeader.className = "header";
		divHeader.innerText = user.account;
		divContent.appendChild(divHeader);
		
		
		
		var divMeta = document.createElement("div");
		divMeta.className = "ui sub header";
		
		var a = document.createElement("a");
		a.innerText = user.level;
		divMeta.appendChild(a);
		
		divContent.appendChild(divMeta);
		
		
		
		var divDescription = document.createElement("div");
		divDescription.className = "description";
		divDescription.innerHTML = "Last query: " + "<a href='/@" + user.account + "/" + user.last_query + "'>" + user.last_query_title + "</a>";
		
		divContent.appendChild(divDescription);
		
		
		
		
		
		var divExtra = document.createElement("div");
		divExtra.className = "extra content";
		
		var spanJoined = document.createElement("span");
		spanJoined.className = "right floated timeago";
		spanJoined.title = user.created;
		divExtra.appendChild(spanJoined);
		
		
		var spanQueries = document.createElement("span");
		spanQueries.innerHTML = "<i class='question icon'></i>" + user.query_count + " queries";
		divExtra.appendChild(spanQueries);
		
		
		
		var a_Button = document.createElement("a");
		a_Button.className = "ui bottom attached button";
		a_Button.innerHTML = "<i class='eye icon'></i> See account";
		a_Button.href = "/@" + user.account;
		
		
		
		
		
		divCard.appendChild(divContent);
		divCard.appendChild(divExtra);
		
		divCard.appendChild(a_Button);
		
		
		document.getElementById("user_list").appendChild(divCard);

	}
  
  
  
  


var  api = "/api/hot_users/0";
	
	
function fetch_users(api) {
	
	

	document.getElementById("user_list").innerHTML = "";
	
	document.getElementById("loader").style.display = "block";
	
	
$.get(api, function(data, status){

    //results = JSON.parse(data);
	
    results = data;
	
	console.log(data);
	
	
	document.getElementById("loader").style.display = "none";
	
	
	var tags = results[0];
	
	for (x in tags) {
		list_users(tags[x]);
	}
	
	timeAgo();
	
	
});

}


fetch_users(api);
	
	
	
	

  </script>

  
  
</body>

</html>
